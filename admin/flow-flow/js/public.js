window.CustomModernizr=function(h,r){function t(t){f.cssText=t}function a(t,e){return typeof t===e}function o(t,e){for(var i in t){var n=t[i];if(!~(""+n).indexOf("-")&&f[n]!==r)return"pfx"!=e||n}return!1}function n(t,e,i){var n=t.charAt(0).toUpperCase()+t.slice(1),s=(t+" "+g.join(n+" ")+n).split(" ");return a(e,"string")||void 0===e?o(s,e):function(t,e,i){for(var n in t){var s=e[t[n]];if(s!==r)return!1===i?t[n]:a(s,"function")?s.bind(i||e):s}return!1}(s=(t+" "+v.join(n+" ")+n).split(" "),e,i)}function e(t,e,i,n){var s,r,a,o,l=h.createElement("div"),d=h.body,f=d||h.createElement("body");if(parseInt(i,10))for(;i--;)(a=h.createElement("div")).id=n?n[i]:p+(i+1),l.appendChild(a);return s=["&#173;",'<style id="s',p,'">',t,"</style>"].join(""),l.id=p,(d?l:f).innerHTML+=s,f.appendChild(l),d||(f.style.background="",f.style.overflow="hidden",o=c.style.overflow,c.style.overflow="hidden",c.appendChild(f)),r=e(l,t),d?l.parentNode.removeChild(l):(f.parentNode.removeChild(f),c.style.overflow=o),!!r}var i,s,l={},c=h.documentElement,p="modernizr",d=h.createElement(p),f=d.style,u=" -webkit- -moz- -o- -ms- ".split(" "),m="Webkit Moz O ms",g=m.split(" "),v=m.toLowerCase().split(" "),y={},w=[],x=w.slice,b={}.hasOwnProperty;for(var _ in s=void 0!==b&&void 0!==b.call?function(t,e){return b.call(t,e)}:function(t,e){return e in t&&void 0===t.constructor.prototype[e]},Function.prototype.bind||(Function.prototype.bind=function(n){var s=this;if("function"!=typeof s)throw new TypeError;var r=x.call(arguments,1),a=function(){if(this instanceof a){function t(){}t.prototype=s.prototype;var e=new t,i=s.apply(e,r.concat(x.call(arguments)));return Object(i)===i?i:e}return s.apply(n,r.concat(x.call(arguments)))};return a}),y.csstransforms=function(){return!!n("transform")},y.csstransforms3d=function(){var i=!!n("perspective");return i&&"webkitPerspective"in c.style&&e("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t,e){i=9===t.offsetLeft&&3===t.offsetHeight}),i},y.csstransitions=function(){return n("transition")},y)s(y,_)&&(i=_.toLowerCase(),l[i]=y[_](),w.push((l[i]?"":"no-")+i));return l.addTest=function(t,e){if("object"==typeof t)for(var i in t)s(t,i)&&l.addTest(i,t[i]);else{if(t=t.toLowerCase(),l[t]!==r)return l;e="function"==typeof e?e():e,c.className+=" "+(e?"":"no-")+t,l[t]=e}return l},t(""),d=null,l._version="2.6.2",l._prefixes=u,l._domPrefixes=v,l._cssomPrefixes=g,l.testProp=function(t){return o([t])},l.testAllProps=n,l.testStyles=e,l.prefixed=function(t,e,i){return e?n(t,e,i):n(t,"pfx")},c.className=c.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(" js "+w.join(" ")),l}(this.document),window.findAndReplaceDOMText=function(){var i="retain",v=document;function o(){return function(t,e,i,n,s){if(e&&!e.nodeType&&arguments.length<=2)return!1;var r="function"==typeof i;r&&(i=function(i){return function(t,e){return i(t.text,e.startIndex)}}(i));var a=l(e,{find:t,wrap:r?null:i,replace:r?i:"$"+(n||"&"),prepMatch:function(t,e){if(!t[0])throw"findAndReplaceDOMText cannot handle zero-length matches";if(0<n){var i=t[n];t.index+=t[0].indexOf(i),t[0]=i}return t.endIndex=t.index+t[0].length,t.startIndex=t.index,t.index=e,t},filterElements:s});return o.revert=function(){return a.revert()},!0}.apply(null,arguments)||l.apply(null,arguments)}function l(t,e){return new n(t,e)}function n(t,e){e.portionMode=e.portionMode||i,this.node=t,this.options=e,this.prepMatch=e.prepMatch||this.prepMatch,this.reverts=[],this.matches=this.search(),this.matches.length&&this.processMatches()}return(o.Finder=n).prototype={search:function(){var t,e=0,i=this.options.find,n=this.getAggregateText(),s=[];if((i="string"==typeof i?RegExp(String(i).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1"),"g"):i).global)for(;t=i.exec(n);)s.push(this.prepMatch(t,e++));else(t=n.match(i))&&s.push(this.prepMatch(t,0));return s},prepMatch:function(t,e){if(!t[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return t.endIndex=t.index+t[0].length,t.startIndex=t.index,t.index=e,t},getAggregateText:function(){var n=this.options.filterElements;return function t(e){if(3===e.nodeType)return e.data;if(n&&!n(e))return"";var i="";if(e=e.firstChild)for(;i+=t(e),e=e.nextSibling;);return i}(this.node)},processMatches:function(){var t,e,i,n=this.matches,s=this.node,r=this.options.filterElements,a=[],o=s,l=n.shift(),d=0,f=0,h=[s];t:for(;;){if(3===o.nodeType&&(!e&&o.length+d>=l.endIndex?e={node:o,index:f++,text:o.data.substring(l.startIndex-d,l.endIndex-d),indexInMatch:d-l.startIndex,indexInNode:l.startIndex-d,endIndexInNode:l.endIndex-d,isEnd:!0}:t&&a.push({node:o,index:f++,text:o.data,indexInMatch:d-l.startIndex,indexInNode:0}),!t&&o.length+d>l.startIndex&&(t={node:o,index:f++,indexInMatch:0,indexInNode:l.startIndex-d,endIndexInNode:l.endIndex-d,text:o.data.substring(l.startIndex-d,l.endIndex-d)}),d+=o.data.length),i=1===o.nodeType&&r&&!r(o),t&&e){if(o=this.replaceMatch(l,t,a,e),d-=e.node.data.length-e.endIndexInNode,e=t=null,a=[],f=0,!(l=n.shift()))break}else if(!i&&(o.firstChild||o.nextSibling)){o=o.firstChild?(h.push(o),o.firstChild):o.nextSibling;continue}for(;;){if(o.nextSibling){o=o.nextSibling;break}if((o=h.pop())===s)break t}}},revert:function(){for(var t=this.reverts.length;t--;)this.reverts[t]();this.reverts=[]},prepareReplacementString:function(t,e,n,i){var s=this.options.portionMode;return"first"===s&&0<e.indexInMatch?"":(t=t.replace(/\$(\d+|&|`|')/g,function(t,e){var i;switch(e){case"&":i=n[0];break;case"`":i=n.input.substring(0,n.startIndex);break;case"'":i=n.input.substring(n.endIndex);break;default:i=n[+e]}return i}),"first"===s?t:e.isEnd?t.substring(e.indexInMatch):t.substring(e.indexInMatch,e.indexInMatch+e.text.length))},getPortionReplacementNode:function(t,e,i){var n=this.options.replace||"$&",s=this.options.clss,r=this.options.wrap;if(r&&r.nodeType){var a=v.createElement("div");a.innerHTML=r.outerHTML||(new XMLSerializer).serializeToString(r),r=a.firstChild}if("function"==typeof n)return(n=n(t,e,i))&&n.nodeType?n:v.createTextNode(String(n));var o="string"==typeof r?v.createElement(r):r;return s&&(o.className=s),(n=v.createTextNode(this.prepareReplacementString(n,t,e,i))).data&&o?(o.appendChild(n),o):n},replaceMatch:function(t,e,i,n){var s,r,a=e.node,o=n.node;if(a===o){var l=a;0<e.indexInNode&&(s=v.createTextNode(l.data.substring(0,e.indexInNode)),l.parentNode.insertBefore(s,l));var d=this.getPortionReplacementNode(n,t);return l.parentNode.insertBefore(d,l),n.endIndexInNode<l.length&&(r=v.createTextNode(l.data.substring(n.endIndexInNode)),l.parentNode.insertBefore(r,l)),l.parentNode.removeChild(l),this.reverts.push(function(){s===d.previousSibling&&s.parentNode.removeChild(s),r===d.nextSibling&&r.parentNode.removeChild(r),d.parentNode.replaceChild(l,d)}),d}s=v.createTextNode(a.data.substring(0,e.indexInNode)),r=v.createTextNode(o.data.substring(n.endIndexInNode));for(var f=this.getPortionReplacementNode(e,t),h=[],c=0,p=i.length;c<p;++c){var u=i[c],m=this.getPortionReplacementNode(u,t);u.node.parentNode.replaceChild(m,u.node),this.reverts.push(function(t,e){return function(){e.parentNode.replaceChild(t.node,e)}}(u,m)),h.push(m)}var g=this.getPortionReplacementNode(n,t);return a.parentNode.insertBefore(s,a),a.parentNode.insertBefore(f,a),a.parentNode.removeChild(a),o.parentNode.insertBefore(g,o),o.parentNode.insertBefore(r,o),o.parentNode.removeChild(o),this.reverts.push(function(){s.parentNode.removeChild(s),f.parentNode.replaceChild(a,f),r.parentNode.removeChild(r),g.parentNode.replaceChild(o,g)}),g}},o}(),function(y){function f(e,i,n,s,r){var a=!1;return e.contents().detach().each(function(){var t=y(this);if(void 0===this)return!0;if(t.is("script, .dotdotdot-keep"))e.append(t);else{if(a)return!0;e.append(t),!r||t.is(s.after)||t.find(s.after).length||e[e.is("a, table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style")?"after":"append"](r),w(n,s)&&(a=(3==this.nodeType?function(t,e,i,n,s){var r=t[0];if(!r)return!1;var a=_(r),o=-1!==a.indexOf(" ")?" ":"　",l="letter"==n.wrap?"":o,d=a.split(l),f=-1,h=-1,c=0,p=d.length-1;for(n.fallbackToLetter&&0==c&&0==p&&(l="",d=a.split(l),p=d.length-1);c<=p&&(0!=c||0!=p);){var u=Math.floor((c+p)/2);if(u==h)break;h=u,b(r,d.slice(0,h+1).join(l)+n.ellipsis),i.children().each(function(){y(this).toggle().toggle()}),w(i,n)?(p=h,n.fallbackToLetter&&0==c&&0==p&&(l="",d=d[0].split(l),h=f=-1,c=0,p=d.length-1)):c=f=h}if(-1==f||1==d.length&&0==d[0].length){var m=t.parent();t.detach();var g=s&&s.closest(m).length?s.length:0;if(m.contents().length>g?r=I(m.contents().eq(-1-g),e):(r=I(m,e,!0),g||m.detach()),r&&(a=x(_(r),n),b(r,a),g&&s)){var v=s.parent();y(r).parent().append(s),y.trim(v.html())||v.remove()}}else a=x(d.slice(0,f+1).join(l),n),b(r,a);return!0}:f)(t,i,n,s,r)),a||r&&r.detach()}}),i.addClass("is-truncated"),a}function w(t,e){return t.innerHeight()>e.maxHeight}function x(t,e){for(;-1<y.inArray(t.slice(-1),e.lastCharacter.remove);)t=t.slice(0,-1);return y.inArray(t.slice(-1),e.lastCharacter.noEllipsis)<0&&(t+=e.ellipsis),t}function h(t){return{width:t.innerWidth(),height:t.innerHeight()}}function b(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function _(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function r(t){for(;(t=t.previousSibling)&&1!==t.nodeType&&3!==t.nodeType;);return t}function I(t,e,i){var n,s=t&&t[0];if(s){if(!i){if(3===s.nodeType)return s;if(y.trim(t.text()))return I(t.contents().last(),e)}for(n=r(s);!n;){if((t=t.parent()).is(e)||!t.length)return!1;n=r(t[0])}if(n)return I(y(n),e)}return!1}if(!y.fn.dotdotdot){y.fn.dotdotdot=function(t){if(0==this.length)return y.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(1<this.length)return this.each(function(){y(this).dotdotdot(t)});var s=this,r=s.contents();s.data("dotdotdot")&&s.trigger("destroy.dot"),s.data("dotdotdot-style",s.attr("style")||""),s.css("word-wrap","break-word"),"nowrap"===s.css("white-space")&&s.css("white-space","normal"),s.bind_events=function(){return s.bind("update.dot",function(t,e){switch(s.removeClass("is-truncated"),t.preventDefault(),t.stopPropagation(),typeof a.height){case"number":a.maxHeight=a.height;break;case"function":a.maxHeight=a.height.call(s[0]);break;default:a.maxHeight=function(t){for(var e=t.innerHeight(),i=["paddingTop","paddingBottom"],n=0,s=i.length;n<s;n++){var r=parseInt(t.css(i[n]),10);isNaN(r)&&(r=0),e-=r}return e}(s)}a.maxHeight+=a.tolerance,void 0!==e&&(("string"==typeof e||"nodeType"in e&&1===e.nodeType)&&(e=y("<div />").append(e).contents()),e instanceof y&&(r=e)),(d=s.wrapInner('<div class="dotdotdot" />').children()).contents().detach().end().append(r.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var i=!1,n=!1;return o.afterElement&&((i=o.afterElement.clone(!0)).show(),o.afterElement.detach()),w(d,a)&&(n="children"==a.wrap?function(t,e,i){var n=t.children(),s=!1;t.empty();for(var r=0,a=n.length;r<a;r++){var o=n.eq(r);if(t.append(o),i&&t.append(i),w(t,e)){o.remove(),s=!0;break}i&&i.detach()}return s}(d,a,i):f(d,s,d,a,i)),d.replaceWith(d.contents()),d=null,y.isFunction(a.callback)&&a.callback.call(s[0],n,r),o.isTruncated=n}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(s[0],o.isTruncated),o.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(s[0],r),r}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),s.unwatch().unbind_events().contents().detach().end().append(r).attr("style",s.data("dotdotdot-style")||"").removeClass("is-truncated").data("dotdotdot",!1)}),s},s.unbind_events=function(){return s.unbind(".dot"),s},s.watch=function(){if(s.unwatch(),"window"==a.watch){var t=y(window),e=t.width(),i=t.height();t.bind("resize.dot"+o.dotId,function(){e==t.width()&&i==t.height()&&a.windowResizeFix||(e=t.width(),i=t.height(),l&&clearInterval(l),l=setTimeout(function(){s.trigger("update.dot")},100))})}else n=h(s),l=setInterval(function(){if(s.is(":visible")){var t=h(s);n.width==t.width&&n.height==t.height||(s.trigger("update.dot"),n=t)}},500);return s},s.unwatch=function(){return y(window).unbind("resize.dot"+o.dotId),l&&clearInterval(l),s};var e,i,a=y.extend(!0,{},y.fn.dotdotdot.defaults,t),o={},n={},l=null,d=null;return a.lastCharacter.remove instanceof Array||(a.lastCharacter.remove=y.fn.dotdotdot.defaultArrays.lastCharacter.remove),a.lastCharacter.noEllipsis instanceof Array||(a.lastCharacter.noEllipsis=y.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),o.afterElement=(e=a.after,i=s,!!e&&("string"==typeof e?!!(e=y(e,i)).length&&e:!!e.jquery&&e)),o.isTruncated=!1,o.dotId=c++,s.data("dotdotdot",!0).bind_events().trigger("update.dot"),a.watch&&s.watch(),s},y.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0},y.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}},y.fn.dotdotdot.debug=function(t){};var c=1,e=y.fn.html;y.fn.html=function(t){return null!=t&&!y.isFunction(t)&&this.data("dotdotdot")?this.trigger("update",[t]):e.apply(this,arguments)};var i=y.fn.text;y.fn.text=function(t){return null!=t&&!y.isFunction(t)&&this.data("dotdotdot")?(t=y("<div />").text(t).html(),this.trigger("update",[t])):i.apply(this,arguments)}}}(jQuery),jQuery(document).ready(function(r){r(".dot-ellipsis").each(function(){var t=r(this).hasClass("dot-resize-update"),e=r(this).hasClass("dot-timer-update"),n=0,i=r(this).attr("class").split(/\s+/);r.each(i,function(t,e){var i=e.match(/^dot-height-(\d+)$/);null!==i&&(n=Number(i[1]))});var s=new Object;e&&(s.watch=!0),t&&(s.watch="window"),0<n&&(s.height=n),r(this).dotdotdot(s)})}),jQuery(window).on("load",function(){jQuery(".dot-ellipsis.dot-load-update").trigger("update.dot")}),window.ShuffleCustom=function(k,t,a){"use strict";if(typeof t!=="object"){throw new Error("Shuffle.js requires Modernizr.\n"+"http://vestride.github.io/Shuffle/#dependencies")}function e(t){if(!t){return""}return t.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()}).replace(/^ms-/,"-ms-")}var i=t.prefixed("transition"),n=t.prefixed("transitionDelay"),s=t.prefixed("transitionDuration"),r={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[i],o=t.prefixed("transform"),l=e(o),d=t.csstransforms&&t.csstransitions,f=t.csstransforms3d,h="shuffle",c=.3,p="all",u="groups",m=1,g=.001;function v(i,n,s){var r,a,o,l=null,d=0;s=s||{};var l=function(){d=!1===s.leading?0:k.now(),l=null,o=i.apply(r,a),r=a=null};return function(){var t=k.now();d||!1!==s.leading||(d=t);var e=n-(t-d);return r=this,a=arguments,e<=0||n<e?(clearTimeout(l),l=null,d=t,o=i.apply(r,a),r=a=null):l||!1===s.trailing||(l=setTimeout(f,e)),o}}function y(t,e,i){for(var n=0,s=t.length;n<s;n++){if(e.call(i,t[n],n,t)==={}){return}}}function w(t,e,i){return setTimeout(k.proxy(t,e),i)}function x(t){return Math.max.apply(Math,t)}function b(t){return Math.min.apply(Math,t)}function _(t){return k.isNumeric(t)?t:0}var N=function(t,e){this.x=_(t);this.y=_(e)};N.equals=function(t,e){return t.x===e.x&&t.y===e.y};var I=0,C=k(window),T=0,E=function(t,e,i){e=e||{};k.extend(this,E.options,e,E.settings);this.$el=k(t);this.id=T++;this.element=t;this.only_sort=i;this.unique="shuffle_"+I++;this._fire(E.EventType.LOADING);this._init();w(function(){this.initialized=true;this._fire(E.EventType.DONE)},this,16)};function S(t){var e,i,n=t.length;if(!n)return t;while(--n)i=Math.floor(Math.random()*(n+1)),e=t[i],t[i]=t[n],t[n]=e;return t}return E.EventType={LOADING:"loading",DONE:"done",LAYOUT:"layout",REMOVED:"removed"},E.ClassName={BASE:h,SHUFFLE_ITEM:"shuffle-item",FILTERED:"filtered",CONCEALED:"concealed"},E.options={group:p,speed:250,easing:"ease-out",itemSelector:"",sizer:null,gutterWidth:0,columnWidth:0,delimeter:null,buffer:0,initialSort:null,throttle:function(i,n,s){var r,a,o,l=null,d=0;s=s||{};function f(){d=!1===s.leading?0:k.now(),l=null,o=i.apply(r,a),r=a=null}return function(){var t=k.now();d||!1!==s.leading||(d=t);var e=n-(t-d);return r=this,a=arguments,e<=0||n<e?(clearTimeout(l),l=null,d=t,o=i.apply(r,a),r=a=null):l||!1===s.trailing||(l=setTimeout(f,e)),o}},throttleTime:100,sequentialFadeDelay:150,supported:d},E.settings={useSizer:!1,itemCss:{position:"absolute",top:0,left:0,visibility:"visible"},revealAppendedDelay:300,lastSort:{},lastFilter:p,enabled:!0,destroyed:!1,initialized:!1,_animations:[],styleQueue:[]},E.Point=N,E._getItemTransformString=function(t,e){return f?"translate3d("+t.x+"px, "+t.y+"px, 0) scale3d("+e+", "+e+", 1)":"translate("+t.x+"px, "+t.y+"px) scale("+e+")"},E._getNumberStyle=function(t,e){return E._getFloat(k(t).css(e))},E._getInt=function(t){return _(parseInt(t,10))},E._getFloat=function(t){return _(parseFloat(t))},E._getOuterWidth=function(t,e){return k(t).outerWidth(!!e)},E._getOuterHeight=function(t,e){return k(t).outerHeight(!!e)},E._skipTransition=function(t,e,i){var n=t.style[s];t.style[s]="0ms",e.call(i);t.offsetWidth;t.style[s]=n},E.prototype._init=function(){if(this.$items=this._getItems(),!this.only_sort){this.sizer=this._getElementOption(this.sizer),this.sizer&&(this.useSizer=!0),this.$el.addClass(E.ClassName.BASE),this.containerWidth=E._getOuterWidth(this.element),this._itemMargin=this._getGutterSize(this.containerWidth),this._initItems(),C.on("resize."+h+"."+this.unique,this._getResizeFunction());var t=this.$el.css(["position","overflow"]),e=E._getOuterWidth(this.element);this._validateStyles(t),this._setColumns(e)}this.shuffle(this.group,this.initialSort),this.supported&&w(function(){this.destroyed||(this._setTransitions(),this.element.style[i]="height "+this.speed+"ms "+this.easing)},this)},E.prototype._getResizeFunction=function(){var t=k.proxy(this._onResize,this);return this.throttle?this.throttle(t,this.throttleTime):t},E.prototype._getElementOption=function(t){return"string"==typeof t?this.$el.find(t)[0]||null:t&&t.nodeType&&1===t.nodeType?t:t&&t.jquery?t[0]:null},E.prototype._validateStyles=function(t){"static"===t.position&&(this.element.style.position="relative"),t.overflow},E.prototype._filter=function(t,e){t=t||this.lastFilter,e=e||this.$items;var i=this._getFilteredSets(t,e);return this._toggleFilterClasses(i.filtered,i.concealed),"string"==typeof(this.lastFilter=t)&&(this.group=t),i.filtered},E.prototype._getFilteredSets=function(i,t){var n=k(),s=k();return i===p?n=t:y(t,function(t){var e=k(t);this._doesPassFilter(i,e)||e.is(".ff-ad")?n=n.add(e):s=s.add(e)},this),{filtered:n,concealed:s}},E.prototype._doesPassFilter=function(t,e){if(k.isFunction(t))return t.call(e[0],e,this);var i=e.data("groups"),n=this.delimeter&&!k.isArray(i)?i.split(this.delimeter):i;return-1<k.inArray(t,n)},E.prototype._toggleFilterClasses=function(t,e){t.removeClass(E.ClassName.CONCEALED).addClass(E.ClassName.FILTERED),e.removeClass(E.ClassName.FILTERED).addClass(E.ClassName.CONCEALED)},E.prototype._initItems=function(t,x){var b=this;t=t||this.$items;var _,I,C,e,T=this.columnWidth(this.containerWidth,this._itemMargin),S=this.streamOpts.layout;this.itemCss.width=T,this.gridLayout=S,x||(t.addClass([E.ClassName.SHUFFLE_ITEM,E.ClassName.FILTERED].join(" ")),t.css(this.itemCss).data("point",new N).data("scale",1)),"grid"===S?(_=this.streamOpts["g-ratio-h"]*T/this.streamOpts["g-ratio-w"],_=Math.floor(_),I=Math.floor(_*this._altEval(this.streamOpts["g-ratio-img"])),e=t.first(),C=e.find(".ff-item-meta").height(),this._addStyleSheet(".ff-layout-grid .ff-item-cont { height: "+(_-44)+"px; /*overflow:hidden*/} .ff-layout-grid .ff-ad .ff-item-cont { height: "+_+"px; overflow:hidden} .ff-layout-grid .ff-has-overlay .ff-item-cont { height: "+_+"px; /*overflow:hidden*/} .ff-layout-grid .ff-item .ff-img-holder{height: "+I+"px}.ff-layout-grid .ff-has-overlay .ff-img-holder{height: "+_+"px}","ff-grid-css")):this.streamOpts.isOverlay&&(e=t.first(),C=e.find(".ff-item-meta").height()),t.each(function(t){var e,i,n,s,r,a,o,l,d,f,h,c,p,u=k(this),m=u.data(),g=m.media&&m.media.split(";"),v=u.find(".ff-img-holder img"),y={},w=b.streamOpts.isOverlay&&v.length;g&&(i=(e={width:g[4]||g[0],height:g[5]||g[1]}).width&&e.height?b._calcImageProportion(T,e,S):0,v.css("minHeight",i)),"grid"!==S&&!w||(d=u.find(w?".ff-overlay-wrapper":".ff-item-cont"),o=u.find(".ff-content"),l=d.find("> h4"),f=d.children(),w&&(f=f.not(".ff-overlay")),"label1"===b.streamOpts["icon-style"]&&u.is(".ff-meta-first")||(f=f.not(".ff-label-wrapper")),c=parseInt(f.first().css("marginTop")),p=parseInt(f.last().css("marginBottom")),a=.07*T,h=(f.length-1)*a+c+p,r=l.length?l.height():0,(n=(_||i||v.height())-("ad"===u.data("type")?0:(v.length&&!w?I:0)+r+C+44)-h)<21&&(n=20<=n?20:r?0:n<0?21+n-a:n),y={height:n},o.css(y),0!==y.height&&o.length||(s=_-(v.length&&!w?I:0)-C-44-h,y={},(s=Math.floor(s))<=21&&(20<=s?(l.addClass("ff-header-min"),s=21):(s=s<0?21+s-a:s,y.textIndent="-9999px")),(y.height=s)<=0&&l.detach(),l.css(y)),x&&u.find(".ff-content").dotdotdot({ellipsis:"...",after:""}))})},E.prototype._calcImageProportion=function(t,e,i){var n=t/e.width;return Math.round(e.height*n)},E.prototype._addCSSRule=function(t,e,i){if(t&&t.cssRules){for(var n=t.cssRules.length-1,s=n;0<s;s--){var r=t.cssRules[s];r.selectorText===e&&(i=r.style.cssText+i,t.deleteRule(s),n=s)}return t.insertRule?t.insertRule(e+"{"+i+"}",n):t.addRule(e,i,n),t.cssRules[n].cssText}},E.prototype._altEval=function(t){return new Function("return "+t)()},E.prototype._addStyleSheet=function(t,e){var i=document.createElement("style");return i.type="text/css",e&&(i.id=e),/WebKit|MSIE/i.test(navigator.userAgent)?i.styleSheet?i.styleSheet.cssText=t:i.innerText=t:i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i},E.prototype._updateItemCount=function(){this.visibleItems=this._getFilteredItems().length},E.prototype._setTransition=function(t){t.style[i]=l+" "+this.speed+"ms "+this.easing+", opacity "+this.speed+"ms "+this.easing},E.prototype._setTransitions=function(t){y(t=t||this.$items,function(t){this._setTransition(t)},this)},E.prototype._setSequentialDelay=function(t){this.supported&&y(t,function(t,e){t.style[n]="0ms,"+(e+1)*this.sequentialFadeDelay+"ms"},this)},E.prototype._getItems=function(){return this.$el.children(this.itemSelector)},E.prototype._getFilteredItems=function(){return this.destroyed?k():this.$items.filter("."+E.ClassName.FILTERED)},E.prototype._getConcealedItems=function(){return this.$items.filter("."+E.ClassName.CONCEALED)},E.prototype._getColumnSize=function(t,e){var i;return 0===(i=k.isFunction(this.columnWidth)?this.columnWidth(t,e):this.useSizer?E._getOuterWidth(this.sizer):this.columnWidth?this.columnWidth:0<this.$items.length?E._getOuterWidth(this.$items[0],!0):t)&&(i=t),i+e},E.prototype._getGutterSize=function(t){return k.isFunction(this.gutterWidth)?this.gutterWidth(t):this.useSizer?E._getNumberStyle(this.sizer,"marginLeft"):this.gutterWidth},E.prototype._setColumns=function(t){var e=t||E._getOuterWidth(this.element),i=this._itemMargin=this._getGutterSize(e),n=this._getColumnSize(e,i);this.containerWidth=e;var s=((e-=2*i)+i)/n;this.cols=Math.max(Math.floor(s),1),this.colWidth=n},E.prototype._setContainerSize=function(){this.$el.css("height",this._getContainerSize())},E.prototype._getContainerSize=function(){return x(this.positions)},E.prototype._fire=function(t,e){this.$el.trigger(t+"."+h,e&&e.length?e:[this])},E.prototype._resetCols=function(){var t=this.cols;for(this.positions=[];t--;)this.positions.push(0)},E.prototype._layout=function(t,e){var i=this;y(t,function(t){i._layoutItem(t,!!e)},i),i._processStyleQueue(),i._setContainerSize()},E.prototype._layoutItem=function(t,e){var i=k(t),n=i.data(),s=(n.point,n.scale,{width:E._getOuterWidth(t,!0),height:E._getOuterHeight(t,!0)}),r=this._getItemPosition(s);n.point=r,n.scale=1,this.styleQueue.push({$item:i,point:r,scale:1,width:this.itemCss.width,opacity:e?0:1,skipTransition:e,callfront:function(){e||i.css("visibility","visible")},callback:function(){e&&i.css("visibility","hidden")}})},E.prototype._getItemPosition=function(t,e){var i=this._getColumnSpan(t.width,this.colWidth,this.cols),n=this._getColumnSet(i,this.cols),s=this._getShortColumn(n,this.buffer),r=Math.round((this.containerWidth-(t.width*this.cols+this._itemMargin*(this.cols-1)))/2),a=new N(Math.round(this.colWidth*s+(0<r?r:0)),Math.round(n[s]));0!=a.y&&(a.y=a.y+this._itemMargin);for(var o=n[s]+t.height+(0!=a.y?this._itemMargin:0),l=this.cols+1-n.length,d=0;d<l;d++)this.positions[s+d]=o;return a},E.prototype._getColumnSpan=function(t,e,i){var n=t/e;return Math.abs(Math.round(n)-n)<.3&&(n=Math.round(n)),Math.min(Math.ceil(n),i)},E.prototype._getColumnSet=function(t,e){if(1===t)return this.positions;for(var i=e+1-t,n=[],s=0;s<i;s++)n[s]=x(this.positions.slice(s,s+t));return n},E.prototype._getShortColumn=function(t,e){for(var i,n=(i=t,Math.min.apply(Math,i)),s=0,r=t.length;s<r;s++)if(t[s]>=n-e&&t[s]<=n+e)return s;return 0},E.prototype._shrink=function(t){y(t||this._getConcealedItems(),function(t){var e=k(t),i=e.data();.001!==i.scale&&(i.scale=.001,this.styleQueue.push({$item:e,point:i.point,scale:.001,opacity:0,callback:function(){e.css("visibility","hidden")}}))},this)},E.prototype._onResize=function(){if(this.enabled&&!this.destroyed&&!this.isTransitioning){var t=E._getOuterWidth(this.element);if(t!==this.containerWidth){if(this.containerWidth=t,this._itemMargin=this._getGutterSize(this.containerWidth),"grid"===this.gridLayout){var e=document.getElementById("ff-grid-css");e.parentNode.removeChild(e)}this._initItems(this.$items,!0),this.update()}}},E.prototype._getStylesForTransition=function(t,e){var i={opacity:t.opacity};return t.width&&(i.width=t.width),this.supported?i[o]=E._getItemTransformString(t.point,t.scale):(i.left=t.point.x,i.top=t.point.y),i},E.prototype._transition=function(t){var e=this._getStylesForTransition(t);t.$item.data("keep-pos")?(t.$item.removeData("keep-pos"),w(function(){this._startItemAnimation(t.$item,e,t.callfront||k.noop,t.callback||k.noop)},this,1e3)):this._startItemAnimation(t.$item,e,t.callfront||k.noop,t.callback||k.noop)},E.prototype._startItemAnimation=function(t,e,i,n){if(i(),!this.initialized)return t.css(e),void n();if(this.supported)t.css(e),t.on(r,function t(e){e.target===e.currentTarget&&(k(e.target).off(r,t),n())});else{var s=t.stop(!0).animate(e,this.speed,"swing",n);this._animations.push(s.promise())}},E.prototype._processStyleQueue=function(t){var e=k();y(this.styleQueue,function(t){t.skipTransition?this._styleImmediately(t):(e=e.add(t.$item),this._transition(t))},this),0<e.length&&this.initialized?(this.isTransitioning=!0,this.supported?this._whenCollectionDone(e,r,this._movementFinished):this._whenAnimationsDone(this._movementFinished),this.isTransitioning=!1):t||w(this._layoutEnd,this),this.styleQueue.length=0},E.prototype._styleImmediately=function(t){E._skipTransition(t.$item[0],function(){t.$item.css(this._getStylesForTransition(t))},this)},E.prototype._movementFinished=function(){this._layoutEnd()},E.prototype._layoutEnd=function(){this.destroyed||this._fire(E.EventType.LAYOUT)},E.prototype._addItems=function(t,e,i){this._initItems(t),this._setTransitions(t),this.$items=this._getItems(),this._shrink(t),y(this.styleQueue,function(t){t.skipTransition=!0}),this._processStyleQueue(!0),e?this._addItemsToEnd(t,i):this.shuffle(this.lastFilter)},E.prototype._addItemsToEnd=function(t,e){var i=this._filter(null,t).get();this._updateItemCount(),this._layout(i,!0),e&&this.supported&&this._setSequentialDelay(i),this._revealAppended(i)},E.prototype._revealAppended=function(t){w(function(){y(t,function(t){var e=k(t);this._transition({$item:e,opacity:1,point:e.data("point"),scale:1})},this),this._whenCollectionDone(k(t),r,function(){k(t).css(n,"0ms"),this._movementFinished()})},this,this.revealAppendedDelay)},E.prototype._whenCollectionDone=function(t,i,n){var s=0,r=t.length,a=this;t.on(i,function t(e){e.target===e.currentTarget&&(k(e.target).off(i,t),++s===r&&n.call(a))})},E.prototype._whenAnimationsDone=function(t){k.when.apply(null,this._animations).always(k.proxy(function(){this._animations.length=0,t.call(this)},this))},E.prototype.shuffle=function(t,e){this.enabled&&!this.isTransitioning&&(t=t||p,this._filter(t),this._updateItemCount(),this._shrink(),this.sort(e))},E.prototype.sort=function(t){if(this.enabled&&!this.isTransitioning){this._resetCols();var e=t||this.lastSort,i=this._getFilteredItems().sorted(e);this._layout(i),this.lastSort=e}},E.prototype.update=function(t){var o=this;this.enabled&&!this.isTransitioning&&(t||(this._setColumns(),this.$items.css("width",this.colWidth-this._itemMargin),this.$items.each(function(t,e){var i=k(this),n=i.data(),s=n.media&&n.media.split(";");if(s){var r={width:s[4],height:s[5]},a=o._calcImageProportion(o.colWidth-o._itemMargin,r);i.find(".ff-img-holder img").css("minHeight",a)}}),this.itemCss.width=this.colWidth-this._itemMargin),o.sort())},E.prototype.layout=function(){this.destroyed||this.update(!0)},E.prototype.appended=function(t,e,i){this._addItems(t,!0,!0)},E.prototype.disable=function(){this.enabled=!1},E.prototype.enable=function(t){!(this.enabled=!0)!==t&&this.update()},E.prototype.remove=function(t){t.length&&t.jquery&&(this._toggleFilterClasses(k(),t),this._shrink(t),this.sort(),this.$el.one(E.EventType.LAYOUT+"."+h,k.proxy(function(){t.remove(),this.$items=this._getItems(),this._updateItemCount(),this._fire(E.EventType.REMOVED,[t,this]),t=null},this)))},E.prototype.destroy=function(){C.off("."+this.unique),this.$el.removeClass(h).removeAttr("style").removeData(h),this.$items.removeAttr("style").removeData("point").removeData("scale").removeClass([E.ClassName.CONCEALED,E.ClassName.FILTERED,E.ClassName.SHUFFLE_ITEM].join(" ")),this.$items=null,this.$el=null,this.sizer=null,this.element=null,this.destroyed=!0},k.fn.shuffleCustom=function(i){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=k(this),e=t.data(h);e?"string"==typeof i&&e[i]&&e[i].apply(e,n):(e=new E(this,i,"only_sort"===n[1]),t.data(h,e))})},k.fn.sorted=function(t){var s=k.extend({},k.fn.sorted.defaults,t),e=this.get(),r=!1;return e.length?s.randomize?function(t){var e,i,n=t.length;if(!n)return t;for(;--n;)i=Math.floor(Math.random()*(n+1)),e=t[i],t[i]=t[n],t[n]=e;return t}(e):(k.isFunction(s.by)&&e.sort(function(t,e){if(r)return 0;var i=s.by(k(t)),n=s.by(k(e));return i===a&&n===a?(r=!0,0):i<n||"sortFirst"===i||"sortLast"===n?-1:n<i||"sortLast"===i||"sortFirst"===n?1:0}),r?this.get():(s.reverse&&e.reverse(),e)):[]},k.fn.sorted.defaults={reverse:!1,by:null,randomize:!1},E}(window.jQuery,window.CustomModernizr),function(t,f){var n,e=t.jQuery||t.Cowboy||(t.Cowboy={});e.throttle=n=function(s,r,a,o){var l,d=0;function t(){var t=this,e=new Date-d,i=arguments;function n(){d=+new Date,a.apply(t,i)}o&&!l&&n(),l&&clearTimeout(l),o===f&&s<e?n():!0!==r&&(l=setTimeout(o?function(){l=f}:n,o===f?s-e:s))}return"boolean"!=typeof r&&(o=a,a=r,r=f),e.guid&&(t.guid=a.guid=a.guid||e.guid++),t},e.debounce=function(t,e,i){return i===f?n(t,e,!1):n(t,i,!1!==e)}}(this),function(i){"use strict";var t=null,e=i(window),n=function(t){var e=this;if(i.extend(e,n.options,t,n.settings),!i.isFunction(e.enter))throw new TypeError("Viewport.add :: No `enter` function provided in Viewport options.");"string"==typeof e.threshold&&-1<e.threshold.indexOf("%")?(e.isThresholdPercentage=!0,e.threshold=parseFloat(e.threshold)/100):e.threshold<1&&0<e.threshold&&(e.isThresholdPercentage=!0),e.hasLeaveCallback=i.isFunction(e.leave),e.$element=i(e.element),e.update()};n.prototype.update=function(){var t=this;t.offset=t.$element.offset(),t.height=t.$element.height(),t.$element.data("height",t.height),t.width=t.$element.width(),t.$element.data("width",t.width)},n.options={threshold:200,delay:0},n.settings={triggered:!1,isThresholdPercentage:!1};function s(){this.init()}s.prototype={init:function(){var t=this;t.list=[],t.lastScrollY=0,t.windowHeight=e.height(),t.windowWidth=e.width(),t.screenSize={w:t.windowWidth,h:t.windowHeight},t.throttleTime=100,t.onResize(),t.bindEvents(),t.willProcessNextFrame=!0,requestAnimationFrame(function(){t.setScrollTop(),t.process(),t.willProcessNextFrame=!1})},bindEvents:function(){var t=this;e.on("resize.viewport",i.proxy(t.onResize,t)),e.on("scroll.viewport",i.throttle(t.throttleTime,i.proxy(t.onScroll,t))),t.hasActiveHandlers=!0},unbindEvents:function(){e.off(".viewport"),this.hasActiveHandlers=!1},maybeUnbindEvents:function(){this.list.length||this.unbindEvents()},add:function(t){var e=this;e.list.push(t),e.hasActiveHandlers||e.bindEvents(),e.willProcessNextFrame||(e.willProcessNextFrame=!0,requestAnimationFrame(function(){e.willProcessNextFrame=!1,e.process()}))},saveDimensions:function(){var t=this;i.each(t.list,function(t,e){e.update()}),t.windowHeight=e.height(),t.windowWidth=e.width(),t.screenSize={w:t.windowWidth,h:t.windowHeight}},onScroll:function(){this.list.length&&(this.setScrollTop(),this.process())},onResize:function(){this.refresh()},refresh:function(){this.list.length&&this.saveDimensions()},isInViewport:function(t){var e,i=this,n=t.offset,s=t.threshold,r=s,a=i.lastScrollY;return t.isThresholdPercentage&&(s=0),(e=i.isTopInView(a,i.windowHeight,n.top,t.height,s))&&t.isThresholdPercentage&&(e=i.isTopPastPercent(a,i.windowHeight,n.top,t.height,r)),e},isTopInView:function(t,e,i,n,s){return t<=i+s&&i+s<t+e},isTopPastPercent:function(t,e,i,n,s){return s<=(t+e-i)/e},isOutOfViewport:function(t,e){var i,n=t.offset,s=this.lastScrollY;return"bottom"===e&&(i=!this.isBottomInView(s,this.windowHeight,n.top,t.height)),i},isBottomInView:function(t,e,i,n){var s=i+n;return t<s&&s<=t+e},triggerEnter:function(t){setTimeout(function(){t.enter.call(t.element,t)},t.delay),i.isFunction(t.leave)?t.triggered=!0:this.list.splice(i.inArray(t,this.list),1),this.maybeUnbindEvents()},getScreenSize:function(){return this.screenSize},triggerLeave:function(t){setTimeout(function(){t.leave.call(t.element,t)},t.delay),t.triggered=!1},setScrollTop:function(){this.lastScrollY=e.scrollTop()},process:function(){var s=this,t=i.extend([],s.list);i.each(t,function(t,e){var i=s.isInViewport(e),n=e.hasLeaveCallback&&s.isOutOfViewport(e,"bottom");return!e.triggered&&i?s.triggerEnter(e):!i&&n&&e.triggered?s.triggerLeave(e):void 0})}},s.add=function(t){return s.getInstance().add(new n(t))},s.refresh=function(){s.getInstance().refresh()},s.getInstance=function(){return t=t||new s},window.FF_Viewport=s}(jQuery),function(m,t,g){"use strict";var i=m.document.documentElement,h={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[t.prefixed("transition")],c=t.csstransitions,p=t.csstransforms3d;function u(t,e){t.style.WebkitTransform=e,t.style.msTransform=e,t.style.transform=e}function v(){var t=i.clientWidth,e=m.innerWidth;return t<e?e:t}function y(){var t=i.clientHeight,e=m.innerHeight;return t<e?e:t}function n(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function e(t,e){return this.el=t[0],this.$el=t,this.options=n({},this.options),n(this.options,e),this._init()}e.prototype.options={},e.prototype._init=function(){return this.$body=g("body"),this.grid=this.el.querySelector(".ff-stream-wrapper"),this.gridItems=[].slice.call(this.grid.querySelectorAll(".ff-item:not(.ff-ad)")),this.itemsCount=this.gridItems.length,this.$wrapper=this.$el.find(".ff-slideshow"),this.slideshow=this.el.querySelector(".ff-slideshow > ul"),this.$slideshow=g(this.slideshow),this.$slideshow.data("media",!1),this.$wrapper.addClass("ff-"+this.options.iconStyle+"-icon"),this._addSlideShowItems(this.gridItems),this.slideshowItems=[].slice.call(this.slideshow.children),this.current=-1,this.ctrlPrev=this.el.querySelector(".ff-nav-prev"),this.ctrlNext=this.el.querySelector(".ff-nav-next"),this.ctrlClose=this.el.querySelector(".ff-nav-close"),this._initEvents(),this},e.prototype._addSlideShowItems=function(t){var u=this;t.forEach(function(t,e){var i,n,s,r,a,o=g(t),l=g('<li><div class="ff-slide-wrapper"></div></li>'),d=l.find(".ff-slide-wrapper"),f=o.find(".picture-item__inner").children().clone(),h=o.attr("data-type"),c="",p=!1;o.attr("data-media")?(u.$slideshow.data("media",!0),s=o.attr("data-media").split(";"),i=g('<div class="ff-media-wrapper'+("image"==s[3]?"":" ff-video")+'" style="width: 100%; max-height: '+s[1]+'px;"></div>'),d.prepend(i),"image"==s[3]?(r=590<(a=parseInt(s[0]))?590/a*parseInt(s[1]):s[1],c='<span class="ff-img-holder" style="width: '+s[0]+"px; max-height: "+s[1]+"px; height: "+r+"px; background-image: url("+s[2]+');"></span>',i.addClass("ff-slide-img-loading").data("media-image",s[2])):"video/mp4"==s[3]?c='<video controls width="'+s[0]+'" height="'+s[1]+'"><source src="'+s[2]+'" type="video/mp4">Your browser does not support the video tag.</video>':(s[2]=s[2].replace("http:","").replace("https:","").replace("/v/","/embed/").replace("autoplay=1","autoplay=0&fs=1"),c='<iframe width="'+s[0]+'" height="'+s[1]+'" src="'+s[2]+'" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen autoplay="1" wmode="opaque"></iframe>',s[2].indexOf("facebook.com/video/embed")+1&&i.after('<span class="ff-cta">(Click image to play video)</span>')),i.data("media",c),f.find(".ff-img-holder").remove()):f.find(".ff-img-holder").length&&f.find(".ff-img-holder").each(function(t,e){var i=g(this),n=g(this).find("img"),s=n.get(0);p?i.remove():(i.removeClass("ff-img-loading").addClass("ff-img-loaded").css({"background-image":'url("'+s.src+'")',width:parseInt(s.style.width),height:parseInt(s.style.height)}),n.remove(),p=!0)}),d.append(f.not(".ff-img-holder")),n=d.find(".ff-item-cont"),/posts/.test(h)&&(h="wordpress"),n.append(l.find("h4")),n.append(l.find(".ff-article")),n.append(l.find(".ff-content").prepend(l.find(".ff-img-holder"))),n.append(l.find(".ff-item-meta")),n.find(".ff-userpic").append(l.find(".ff-icon")),n.find(".ff-item-meta").prepend(n.find(".ff-userpic")).prepend(d.find(".ff-item-bar")),n.find(".ff-timestamp").before("<br>").before('<span class="ff-posted">'+m.FlowFlowOpts.posted_on+" <span>"+h+"</span></span>"),l.find(".ff-content").each(function(){var t=g(this);t.is(":empty")?t.remove():t.wrap('<div class="ff-table"/>')}),u.$slideshow.append(l.attr("data-type",o.attr("data-type")))}),u.$slideshow.data("media")&&u.$slideshow.addClass("ff-slideshow-media")},e.prototype._initEvents=function(t){var e=this;this.initItemsEvents(this.gridItems),g(this.ctrlPrev).on("click",function(){e._navigate("prev")}),g(this.ctrlNext).on("click",function(){e._navigate("next")}),g(this.ctrlClose).on("click",function(){e._closeSlideshow()}),this.$wrapper.on("click",function(t){g(t.target).closest("li, nav").length||e._closeSlideshow()}),g(m).on("resize",function(){e._resizeHandler()}),g(document).on("keydown",function(t){if(e.isSlideshowVisible)switch(t.keyCode||t.which){case 37:e._navigate("prev");break;case 39:e._navigate("next");break;case 27:e._closeSlideshow()}})},e.prototype.initItemsEvents=function(t,a){var o=this,l=g(this.grid).data("opts")&&g(this.grid).data("opts").titles;a=a||0,t.forEach(function(t,r){g(t).find(".picture-item__inner").on("click",function(t){var e=g(t.target),i=e.closest("a"),n=e.closest("h4").length,s=e.closest(".ff-icon-share").length;if(i.length&&!e.is("img")||s){if("yep"===l&&n)return;if(!n)return}t.preventDefault(),o._openSlideshow(r+a)})})},e.prototype._freezeScroll=function(t){t.preventDefault()},e.prototype.checkScrollbar=function(){this.bodyIsOverflowing=document.body.scrollHeight>document.documentElement.clientHeight,this.scrollbarWidth=this.measureScrollbar()},e.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},e.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},e.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="ff-modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e},e.prototype._openSlideshow=function(t){this.isSlideshowVisible=!0,this.current=t,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("ff-modal-open");var e=this;e._setViewportItems();var i=g(e.currentItem),n=g(e.nextItem),s=g(e.prevItem),r=v(),a=y();(e.$curr=i).find(".ff-media-wrapper").each(function(t,e){var i=g(this);if(i.data("media")&&"inserted"!==i.data("media")){if(i.data("media-image")){var n=new Image;n.src=i.data("media-image"),n.onload=function(){i.removeClass("ff-slide-img-loading")}}i.prepend(i.data("media")),i.data("media","inserted")}}),n.add(s).find(".ff-media-wrapper").each(function(t,e){var i=g(this),n=i.data("media");if(n&&"inserted"!==n&&!/iframe|video/.test(n)){if(i.data("media-image")){var s=new Image;s.src=i.data("media-image"),s.onload=function(){i.removeClass("ff-slide-img-loading")}}i.prepend(i.data("media")),i.data("media","inserted")}}),i.addClass("ff-current ff-show");var o=parseInt(Number(e.currentItem.offsetHeight/2*1));if(a<2*o?o=parseInt(a/2)-25:e.$slideshow.bind("mousewheel DOMMouseScroll",e._freezeScroll),u(e.currentItem,p?"translate3d("+parseInt(Number(e.currentItem.offsetWidth/2*-1))+"px, -"+o+"px, 0px)":"translate(-50%, -50%)"),e.prevItem){s.addClass("ff-show");var l=Number(-1*(r/2+e.prevItem.offsetWidth/2));u(e.prevItem,p?"translate3d("+(l+100)+"px, -50%, 0px)":"translate("+l+"px, -50%)")}if(e.nextItem){n.addClass("ff-show");l=Number(r/2+e.nextItem.offsetWidth/2);u(e.nextItem,p?"translate3d("+(l-100)+"px,-50%, 0px)":"translate("+l+"px, -50%)")}setTimeout(function(){e.$wrapper.addClass("ff-slideshow-open").scrollTop(0)},200)},e.prototype._navigate=function(n){if(!this.isAnimating)if("next"===n&&this.current===this.itemsCount-1||"prev"===n&&0===this.current)this._closeSlideshow();else{this.isAnimating=!0,this._setViewportItems();var s,t,r,a=this,o=v(),l=y(),e=this.currentItem.offsetWidth,d=p?"translate3d(-"+Number(o/2+e/2)+"px, -50%, -150px)":"translate(-"+Number(o/2+e/2)+"px, -50%)",f=p?"translate3d("+Number(o/2+e/2)+"px, -50%, -150px)":"translate("+Number(o/2+e/2)+"px, -50%)";t="next"===n?(s=p?"translate3d( -"+Number(2*o/2+e/2)+"px, -50%, -150px )":"translate(-"+Number(2*o/2+e/2)+"px, -50%)",p?"translate3d( "+Number(2*o/2+e/2)+"px, -50%, -150px )":"translate("+Number(2*o/2+e/2)+"px, -50%)"):(s=p?"translate3d( "+Number(2*o/2+e/2)+"px, -50%, -150px )":"translate("+Number(2*o/2+e/2)+"px)",p?"translate3d( -"+Number(2*o/2+e/2)+"px, -50%, -150px )":"translate(-"+Number(2*o/2+e/2)+"px, -50%)"),a.$slideshow.removeClass("ff-animatable"),("next"===n&&this.current<this.itemsCount-2||"prev"===n&&1<this.current)&&(u(r=this.slideshowItems["next"===n?this.current+2:this.current-2],t),g(r).addClass("ff-show").find(".ff-media-wrapper").each(function(t,e){var i=g(this),n=i.data("media");if(n&&"inserted"!==n&&!/iframe|video/.test(n)){if(i.data("media-image")){var s=new Image;s.src=i.data("media-image"),s.onload=function(){i.removeClass("ff-slide-img-loading")}}i.prepend(i.data("media")),i.data("media","inserted")}}));setTimeout(function(){var t;a.$slideshow.addClass("ff-animatable"),a.$curr.removeClass("ff-current");var e="next"===n?a.nextItem:a.prevItem;g(e).addClass("ff-current").find(".ff-media-wrapper").each(function(t,e){var i=g(this),n=i.data("media");if(n&&"inserted"!==n){if(i.data("media-image")){var s=new Image;s.src=i.data("media-image"),s.onload=function(){i.removeClass("ff-slide-img-loading")}}i.prepend(i.data("media")),i.data("media","inserted")}}),u(a.currentItem,"next"===n?d:f),a.nextItem&&(t=parseInt(Number(a.nextItem.offsetHeight/2*1)),l<2*t?(t=parseInt(l/2)-25,"next"===n&&a.$slideshow.off("mousewheel DOMMouseScroll",a._freezeScroll)):"next"===n&&(a.$slideshow.on("mousewheel DOMMouseScroll",a._freezeScroll),a.$wrapper.scrollTop(0)),u(a.nextItem,"next"===n?p?"translate3d("+parseInt(Number(a.nextItem.offsetWidth/2*-1))+"px, -"+t+"px, 0px)":"translate(-50%, -50%)":s)),a.prevItem&&(t=parseInt(Number(a.prevItem.offsetHeight/2*1)),l<2*t?(t=parseInt(l/2)-25,"prev"===n&&a.$slideshow.off("mousewheel DOMMouseScroll",a._freezeScroll).scrollTop(0)):"prev"===n&&(a.$slideshow.on("mousewheel DOMMouseScroll",a._freezeScroll),a.$wrapper.scrollTop(0)),u(a.prevItem,"next"===n?s:p?"translate3d("+parseInt(Number(a.prevItem.offsetWidth/2*-1))+"px, -"+t+"px, 0px)":"translate(-50%, -50%)")),r&&u(r,"next"===n?f:d);var i=function(t){if(c&&800<=o){if(-1===t.originalEvent.propertyName.indexOf("transform"))return!1;g(this).off(h,i)}a.prevItem&&"next"===n?g(a.prevItem).removeClass("ff-show"):a.nextItem&&"prev"===n&&g(a.nextItem).removeClass("ff-show"),a._resetMedia(g(a.currentItem)),"next"===n?(a.prevItem=a.currentItem,a.currentItem=a.nextItem,r&&(a.nextItem=r)):(a.nextItem=a.currentItem,a.currentItem=a.prevItem,r&&(a.prevItem=r)),a.$curr=g(a.currentItem),a.current="next"===n?a.current+1:a.current-1,a.isAnimating=!1};c&&800<=o?a.$curr.on(h,i):i()},25)}},e.prototype._closeSlideshow=function(t){this.$wrapper.removeClass("ff-slideshow-open"),this.$slideshow.removeClass("ff-animatable").unbind("mousewheel DOMMouseScroll",this._freezeScroll),this.resetScrollbar(),this.$body.removeClass("ff-modal-open");var i=this,n=function(t){if(c&&t){if("section"!==t.target.tagName.toLowerCase())return;g(this).off(h,n)}var e=g(i.currentItem);(i.$curr=e).removeClass("ff-current"),e.removeClass("ff-show"),i._resetMedia(e),i.prevItem&&g(i.prevItem).removeClass("ff-show"),i.nextItem&&g(i.nextItem).removeClass("ff-show"),i.slideshowItems.forEach(function(t){u(t,"")}),i.isSlideshowVisible=!1};c?this.$wrapper.on(h,n):n()},e.prototype._resetMedia=function(t){var e=t.attr("data-type");if("vine"!==e&&"soundcloud"!==e){var i=t.find(".ff-video"),n=i.find("iframe, video");i.prepend(n)}},e.prototype._setViewportItems=function(){this.currentItem=null,this.prevItem=null,this.nextItem=null,this.$curr=null,0<this.current&&(this.prevItem=this.slideshowItems[this.current-1]),this.current<this.itemsCount-1&&(this.nextItem=this.slideshowItems[this.current+1]),this.currentItem=this.slideshowItems[this.current],this.$curr=g(this.currentItem)},e.prototype._resizeHandler=function(){var t=this;this._resizeTimeout&&clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(function(){t._resize(),t._resizeTimeout=null},50)},e.prototype._resize=function(){if(this.isSlideshowVisible){if(this.prevItem){var t=Number(-1*(v()/2+this.prevItem.offsetWidth/2));u(this.prevItem,p?"translate3d("+t+"px, -50%, -150px)":"translate("+t+"px, -50%)")}if(this.nextItem){t=Number(v()/2+this.nextItem.offsetWidth/2);u(this.nextItem,p?"translate3d("+t+"px, -50%, -150px)":"translate("+t+"px, -50%)")}}},m.CBPGridGallery=e}(window,window.CustomModernizr,window.jQuery),function($){function o(t,g,e){var v,i,n,s,r=0,a=[],o=(e=jQuery.makeArray(e||t.querySelectorAll(g.itemSelector))).length,l=$(t),d=$(e),f=t.getBoundingClientRect(),h=g.sizes.spacing;for(C=h.length;C--;)if(s=h[C].size,f.width<s){n=parseInt(h[C].val);break}for(var c,p,u,m,y,w,x=Math.floor(f.right-f.left)-2*n,b=[],_=F(x,g.sizes.row),I=F(x,g.sizes.spacing),C=0;C<o;++C)!(c=e[C].getElementsByTagName("img")[0])||e[C].className.indexOf("ff-ad")+1?(p=300,u=_):((m=c.getAttribute("data-size"))&&(m=m.split(";"),p=parseInt(m[0]),u=parseInt(m[1])),p&&u||((p=parseInt(c.getAttribute("width")))||c.setAttribute("width",p=c.offsetWidth),(u=parseInt(c.getAttribute("height")))||c.setAttribute("height",u=c.offsetHeight))),b[C]={width:(y=p,w=_/u,Math.round(y*w)),height:_};l.css("padding","0 "+n+"px"),o=e.length;for(var T=0;T<o;++T){if(e[T].classList?(e[T].classList.remove(g.firstItemClass),e[T].classList.remove(g.lastRowClass)):e[T].className=e[T].className.replace(new RegExp("(^|\\b)"+g.firstItemClass+"|"+g.lastRowClass+"(\\b|$)","gi")," "),r+=b[T].width,a.push(e[T]),T===o-1)for(var S=0;S<a.length;S++)0===S&&(a[S].className+=" "+g.lastRowClass),a[S].style.cssText="width: "+b[T+parseInt(S)-a.length+1].width+"px;height: "+b[T+parseInt(S)-a.length+1].height+"px;margin-right:"+(S<a.length-1?I+"px":0);if(r+I*(a.length-1)>x){var k,N=r+I*(a.length-1)-x,E=(a.length,0);for(S=0;S<a.length;S++){k=a[S];var M=b[T+parseInt(S)-a.length+1].width,z=M-M/r*N,O=Math.round(b[T+parseInt(S)-a.length+1].height*(z/M));z=.5<=E+1-z%1?(E-=z%1,Math.floor(z)):(E+=1-z%1,Math.ceil(z)),k.style.cssText="width: "+z+"px;height: "+O+"px;margin-right: "+(S<a.length-1?I:0)+"px;margin-bottom: "+I+"px",k.querySelectorAll(".ff-img-holder").length?k.querySelectorAll(".ff-img-holder")[0].style.cssText="width: "+z+"px;height: "+O+"px;":k.querySelectorAll(".picture-item__inner")[0].style.cssText="width: "+z+"px;height: "+O+"px;",$(k).data("newHeight",O),$(k).data("newWidth",z),0===S&&(k.className+=" "+g.firstItemClass)}a=[],r=0}}function F(t,e){var i,n;for(i=e.length;i--;)if(t<e[i].size){n=parseInt(e[i].val);break}return n}i=d.not(".ff-ad").first(),v=i.find(".ff-item-meta").height(),d.each(function(t){var e,i,n,s,r,a,o,l,d,f,h,c=$(this),p=c.data(),u=(p.media&&p.media.split(";"),{}),m=!!c.find(".ff-img-holder img").length;o=c.find(m?".ff-overlay-wrapper":".ff-item-cont"),r=c.find(".ff-content"),a=c.find(".ff-overlay-wrapper > h4"),l=(l=o.children()).not(".ff-overlay"),"label1"===g.streamOpts["icon-style"]&&c.is(".ff-meta-first")||(l=l.not(".ff-label-wrapper")),f=parseInt(l.first().css("marginTop")),h=parseInt(l.last().css("marginBottom")),s=.07*c.data("newWidth"),d=(l.length-1)*s+f+h,n=a.length?a.height():0,(e=c.data("newHeight")-n-v-44-d)<21&&(e=20<=e?20:n?0:e<0?21+e-s:e),u={height:e},r.css(u),0!==u.height&&r.length||(i=c.data("newHeight")-v-44-d,u={},(i=Math.floor(i))<=21&&(20<=i+s?(a.addClass("ff-header-min"),i=21):(i=i<0?21+i-s:i,u.textIndent="-9999px")),(u.height=i)<=0&&a.detach(),a.css(u))})}$.fn.rowGrid=function(r,a){return this.each(function(){var t,e,i,n,s=$(this);"appended"===r?(r=s.data("grid-options"),t=(e=s.children("."+r.lastRowClass)).nextAll(r.itemSelector).add(e),o(this,r,t)):"shuffle"===r?(r=s.data("grid-options"),t=s.data("items"),i=this,(n=function(n,t){var s=$(),r=$();return function(t,e,i){for(var n=0,s=t.length;n<s;n++)if(e.call(i,t[n],n,t)==={})return}(t,function(t){var e,i=$(t);e=i,n.call(e[0],e)||i.is(".ff-ad")?s=s.add(i):r=r.add(i)},this),{filtered:s,concealed:r}}(a,t)).filtered.each(function(){var t=$(this);t.add(t.find(".ff-img-holder, .picture-item__inner")).removeAttr("style")}),n.concealed.hide(),$(i).data("group",n.filtered),t=n.filtered,o(this,r,t)):(r=$.extend({},$.fn.rowGrid.defaults,r),s.data("grid-options",r),o(this,r),r.resize&&$(window).on("resize.rowGrid",{container:this},function(t){var e=$(t.data.container).data("group");e&&e.each(function(){var t=$(this);t.add(t.find(".ff-img-holder, .picture-item__inner")).removeAttr("style")}),$(t.data.container).find(".ff-item:not(.ff-ad) .ff-content").dotdotdot({ellipsis:"...",after:""}),o(t.data.container,r,e)}))})},$.fn.rowGrid.defaults={minMargin:null,maxMargin:null,resize:!0,lastRowClass:"last-row",firstItemClass:null}}(jQuery),function(i){"use strict";var t,n,e=i("html"),s=navigator.userAgent.toLowerCase(),r=/safari|chrome/.test(s),O=/android|blackBerry|iphone|ipad|ipod|opera mini|iemobile/i.test(s),a=/msie|trident.*rv\:11\./.test(s),o=/firefox/.test(s),C=!1,F=window.FlowFlowOpts;if(a){if(/msie 8/.test(s))return;t=/msie 9/.test(s)}e.addClass("ff-browser-"+(r?/chrome/.test(s)?"chrome":"safari":a?"ie"+(t?" ff-ie9":""):o?"ff":"")),i.expr.createPseudo&&"function"==typeof i.expr.createPseudo?i.expr[":"].contains=i.expr.createPseudo(function(e){return function(t){return 0<=i(t).text().toUpperCase().indexOf(e.toUpperCase())}}):jQuery.expr[":"].contains=function(t,e,i){return 0<=jQuery(t).text().toUpperCase().indexOf(i[3].toUpperCase())};var T,$,h,c,p,S,l=(T=i,$="agoStyleDate"===F.date_style?function(t,e){return function(t){var e,i,n,s,r,a,o=F.server_time,l=o-t,d=new Date(1e3*t),f=h.length-1;for(a=f;0<=a&&(e=l/h[a])<=1;a--);a<0&&(a=0);switch(e=Math.floor(e),a){case 3:if(1==e){i=F.dates.Yesterday;break}case 4:case 5:n=d.getMonth(),s=d.getDate(),i=c[n]+" "+s;break;case 6:case 7:n=d.getMonth(),s=d.getDate(),r=d.getFullYear(),i=c[n]+" "+s+", "+r;break;default:h[a],i=function(t,e){var i=p;return i=i[e],t+i+" "+F.dates.ago}(e,a)}return i}(t)}:function(t,e){return e},h=[1,60,3600,86400,604800,2630880,31570560,315705600],c=F.dates.months,p=[F.dates.s,F.dates.m,F.dates.h],FF_Viewport.getInstance(),{init:d,streams:S={},addTransitionToItems:v,addViewportItems:g,prepareImageFor:N,adjustItems:k,shuffle:f,recalcLayout:function(t){t.$el.layout()},buildItems:E,buildStreamWith:function(t,i,e,n){var s,r,a,o,l,d,f,h="";if("string"==typeof i.feeds&&(i.feeds=JSON.parse(i.feeds)),0===i.feeds.length)return"<p>No feeds to show. Add at least one</p>";if(!i.layout)return"<p>Please choose stream layout on options page</p>";i.hash=t.hash,i["next-page"]=t.page+1,i.countOfPages=t.countOfPages;var c,p,u,m,g,v=t.items,y=0,w=v.length,x=T('[id^="ff-uid-"]').length+1||1;if("yep"===i.gallery&&(h+='<section class="ff-slideshow"><ul></ul><nav><span class="ff-nav-prev"></span><span class="icon ff-nav-next"></span><span class="ff-nav-close"></span></nav><div class="ff-nav-info-keys">'+window.FlowFlowOpts.lightbox_navigate+"</div></section>"),h+='<div class="ff-header ff-loading">',i.heading&&(h+="<h1>"+i.heading.replace(/\\/g,"")+"</h1>"),i.subheading&&(h+="<h2>"+i.subheading.replace(/\\/g,"")+"</h2>"),"yep"===i.filter){for(l="",d={},y=f=0;y<w;y++)d[v[y].type]=1;for(var b in d)"ad"!==b&&(f+=1,l+='<span class="ff-filter ff-type-'+b+'" data-filter="'+b+'"></span>');h+='<div class="ff-filter-holder">'+(1<f?'<span class="ff-filter ff-type-all ff-filter--active">'+F.filter_all+"</span>"+l:"")+'<span class="ff-search"><input type="text" placeholder="'+F.filter_search+'"/></span></div>'}if(e&&(F.moderation=e,h+='<div class="ff-moderation-holder"><p><strong>PREMODERATION MODE IS ON</strong>. APPROVE POSTS AND HIT <strong>APPLY CHANGES</strong>.</p><span class="ff-moderation-button ff-moderation-apply">Apply changes</span><span class="ff-moderation-button ff-moderation-approve-new">Approve new posts</span></div>'),h+="</div>",i["gc-style"],h+='<div class="ff-stream-wrapper ff-'+(O?"mobile":"desktop")+" shuffle--container"+("yep"===i.viewportin&&!O&&window.requestAnimationFrame?" shuffle--animatein":" shuffle--animateoff")+" ff-layout-"+i.layout+" ff-upic-"+i["upic-pos"]+" ff-upic-"+i["upic-style"]+" ff-align-"+i.talign+" ff-sc-"+i["icon-style"]+" ff-"+i["icons-style"]+'-icon">',h+=E(v,x,!0,e,i),h+='<div class="shuffle__sizer"></div></div>',1<t.countOfPages&&t.page+1!=t.countOfPages&&("yep"!==i.mobileslider||!O)&&(h+='<div class="ff-loadmore-wrapper"><span class="ff-btn">'+window.FlowFlowOpts.show_more+"</span></div>"),(s=T(h)).each(function(t){if(this.className.indexOf("ff-stream-wrapper")+1)return r=T(this),!1}),o=(a=s.find(".ff-item")).not(".ff-ad"),r.data("opts",i).data("items",a),o.each(function(){var t=T(this);t.is(".ff-image")?t.find("img").not(".ff-initial-image").remove():t.find("img").not(":first").remove()}),s.find("p:empty, .ff-content a:empty").remove(),s.find("img").each(function(){N.apply(this,[r])}),s.find(".ff-filter").click(function(){s.find(".ff-filter--active").removeClass("ff-filter--active");var t=T(this).addClass("ff-filter--active").attr("data-filter");!function(t,n){C||(t.find(".ff-item").each(z),C=!0);var e="justified"!==t.data("opts").layout?"shuffleCustom":"rowGrid";t[e]("shuffle",function(t,e){if(e&&"all"!==e.group&&-1===T.inArray(e.group,t.data("groups")))return!1;var i=T.trim(t.attr("data-type")).toLowerCase();return n?-1!==i.indexOf(n):1},"only_sort")}(r,t)}),s.find(".ff-search input").on("keyup",function(){var t=this.value.toLowerCase();M(r,t)}),s.on("click","a",function(){var t,e=T(this);return e.closest(".ff-share-popup").length?(t=T(this).attr("href"),window.open(t,"sharer","toolbar=0,status=0,width=626,height=436"),!1):(!e.is(".ff-no-link")||"nope"!==i.gallery&&!O)&&void 0}),s.on("click",".ff-icon-share",function(t){var e=T(this).parent();return e.data("opened")?(e.removeClass("ff-popup__visible"),e.data("opened",!1)):(e.addClass("ff-popup__visible"),e.data("opened",!0)),!1}),"nope"===i.gallery?(r.addClass("ff-gallery-off").on("click",'.ff-item:not(".ff-ad") .picture-item__inner',function(t){var e=T(t.target),i=T(this);if(!e.closest("a").length||e.is("img"))return O?i.toggleClass("ff-taped"):function(t){if(document.createEvent){var e=document.createEvent("MouseEvents");e.initEvent("click",!1,!0),t.dispatchEvent(e)}else document.createEventObject?t.fireEvent("onclick"):"function"==typeof t.onclick&&t.onclick()}(i.find(".ff-timestamp")[0]),!1}),r.on("click",".ff-timestamp",function(t){t.stopImmediatePropagation()})):r.addClass("ff-gallery-on"),"yep"===F.open_in_new){var _=location.hostname;s.find("a").filter(function(){return this.hostname!=_}).attr("target","_blank")}for(var I in k(o,i),e&&(c=s,u=(p=i).id,m=p.hash,g={},c.find(".ff-moderation-apply").click(function(t){var e=T.post(FlowFlowOpts.ajaxurl,{action:"moderation_apply_action",moderation_action:"custom_approve",stream:u,changed:g,hash:m});T.when(e).done(function(t){location.reload()})}),c.find(".ff-moderation-approve-new").click(function(t){var e=T.post(FlowFlowOpts.ajaxurl,{action:"moderation_apply_action",moderation_action:"new_posts_approve",stream:u,hash:m});T.when(e).done(function(t){location.reload()})}),c.on("change",".ff-moderation-wrapper input",function(t){var e=T(this),i=e.is(":checked"),n=e.closest(".ff-item").attr("post-id");e.closest(".ff-moderation-wrapper")[i?"addClass":"removeClass"]("ff-approved"),g[n]={approved:i}})),S[i.id]=r,n)n[I]&&this[I].init(r);return s},setupGrid:function(t,e,i,n,s,r){setTimeout(function(){f(t,e,i,n,s,r)},0)},adjustImgHeight:function(t,s){t.find("img").each(function(){var t=T(this),e=parseInt(t.css("height")),i=parseInt(t.css("width")),n=s/i;t.css("height",Math.round(e*n)+"px")})}});function d(){return T(document).bind("ffimgloaded",function(t,e){var i=e.$grid.data("shuffle");i&&i.layout()}),d=function(){return l},l}function k(t,e){for(var o,i=0,n=e.template.length;i<n;i++)"image"===e.template[i]&&(o=i);t.each(function(t,e){var i,n,s=T(e),r=s.find(".ff-img-holder"),a="insertBefore";r.closest(".ff-content").length&&(i=s.find(".ff-item-cont").children().not(".ff-label-wrapper"),o>=i.length?(n=i.length-1,o>i.length&&(a="insertAfter")):n=o,r[a](i.eq(n))),s.addClass("ff-"+(r.length?"":"no-")+"image")})}function N(t){var e,i,n,s,r=T(this),a=this,o=r.parent(),l=o.is("a")?o:r;(n=r.data("size"))&&(e=n.split(";")[1],i=e&&0!=e),i||(e=r.attr("height")||r.height(),i=e&&0!=e),o.is(".ff-img-holder")||(r.removeAttr("width").removeAttr("height"),s=T('<span class="ff-img-holder ff-img-loading" style="width: 100%;max-height: none"></span>'),l.wrap(s)),a.onload=function(){i||T(document).trigger("ffimgloaded",{$grid:t}),r.closest(".ff-img-holder").removeClass("ff-img-loading").addClass("ff-img-loaded"),a=r=null},a.onerror=function(){r.closest(".ff-img-holder").removeClass("ff-img-loading").addClass("ff-img-loaded"),a=r=null},l=o=null}function E(t,e,i,n,s,r){var a,o,l,d,f,h,c,p,u,m,g,v,y,w,x,b,_,I,C=t.length,T="",S="",k="",N=s["icon-style"]&&-1<s["icon-style"].indexOf("stamp"),E=e;for(r=r||0,s&&"randomCompare"==s.order&&(t=function(t){var e,i,n=t.length;for(;0!==n;)i=Math.floor(Math.random()*n),e=t[--n],t[n]=t[i],t[i]=e;return t}(t)),a=0;a<C;a++){if(l=t[a],o=a+1,u=k=p=I=S="",w={},_=s.isOverlay&&(!!l.img||-1!==l.text.indexOf("<img")),"ad"!==l.type){c=void 0!==l.source?l.source:l.permalink,n&&l.mod&&(x="new"==l.status?" ff-moderation-new-post":"",b="approved"==l.status?"checked":"",S='<div class="ff-moderation-wrapper '+("approved"==l.status?"ff-approved":"")+x+'"><span>Approve</span> <label for="ff-mod-'+(E+r)+'"><input id="ff-mod-'+(E+r)+'" type="checkbox" class="ff-switcher" value="yes" '+b+"/><div><span></span></div></label></div>"),l.additional&&("twitter"===l.type&&(u+='<a href="https://twitter.com/intent/tweet?in_reply_to='+l.id+'" class="ff-comments"> <i class="ff-icon-reply"></i></a>'),-1<(y=parseInt(l.additional.views))&&(u+='<a href="'+l.permalink+'" class="ff-views"><i class="ff-icon-view"></i> <span>'+(y<0?"":A(y,2))+"</span></a>"),-1<(m=parseInt(l.additional.likes))&&"twitter"!==l.type&&(u+='<a href="'+l.permalink+'" class="ff-likes"><i class="ff-icon-like"></i> <span>'+(m<0?"":A(m,2))+"</span></a>"),-1<(v=parseInt(l.additional.shares))&&(u+='<a href="'+("twitter"===l.type?"https://twitter.com/intent/retweet?tweet_id="+l.id:l.permalink)+'" class="ff-shares"><i class="ff-icon-shares"></i> <span>'+(v<0?"":A(v,2))+"</span></a>"),-1<m&&"twitter"===l.type&&(u+='<a href="https://twitter.com/intent/favorite?tweet_id='+l.id+'" class="ff-likes"><i class="ff-icon-like"></i> <span>'+(m<0?"":A(m,2))+"</span></a>"),g=parseInt(l.additional.comments),"twitter"!==l.type&&-1<g&&(u+='<a href="'+l.permalink+'" class="ff-comments"><i class="ff-icon-comment"></i> <span>'+(-1<g?A(g,2):"")+"</span></a>")),i&&(k+='<div class="ff-share-wrapper"><i class="ff-icon-share"></i><div class="ff-share-popup"><a href="http://www.facebook.com/sharer.php?u='+(h=encodeURIComponent(l.permalink))+'" class="ff-fb-share"><span>Facebook</span></a><a href="https://twitter.com/share?'+(l.header?"text="+encodeURIComponent(l.header)+"&":"")+"url="+h+'" class="ff-tw-share"><span>Twitter</span></a><a href="https://plus.google.com/share?url='+h+'" class="ff-gp-share"><span>Google+</span></a><a href="https://www.pinterest.com/pin/create/button/?url='+h+(l.media?"&media="+encodeURIComponent(l.media.url):"")+'" class="ff-pin-share"><span>Pinterest</span></a></div></div>'),I=l.media?' data-media="'+l.media.width+";"+l.media.height+";"+("yep"===F.forceHTTPS?l.media.url.replace("http:","https:"):l.media.url)+";"+l.media.type+(l.img?";"+l.img.width+";"+l.img.height:"")+'"':"",w.image=l.img?'<span class="ff-img-holder ff-img-loading" '+I+'><img class="ff-initial-image" src="'+("yep"===F.forceHTTPS?l.img.url.replace("http:","https:"):l.img.url)+'" data-size="'+l.img.width+";"+l.img.height+'" /></span>':"",w.header=l.header?'<h4><a rel="nofollow" href="'+c+'">'+l.header+"</a></h4>":"",w.text='<div class="ff-content">'+l.text+"</div>",w.meta='<div class="ff-item-meta"><span class="ff-userpic" style="background:url('+("yep"===F.forceHTTPS?l.userpic.replace("http:","https:"):l.userpic)+')"><i class="ff-icon"><i class="ff-icon-inner"></i></i></span><h6><a rel="nofollow" href="'+l.userlink+'" class="ff-name '+(l.userlink?"":" ff-no-link")+'">'+l.screenname+"</a></h6>"+(l.nickname?'<a rel="nofollow" href="'+l.userlink+'" class="ff-nickname'+(l.userlink?"":" ff-no-link")+'">'+l.nickname+"</a>":"")+'<a rel="nofollow" href="'+l.permalink+'" class="ff-timestamp">'+$(l.system_timestamp,l.timestamp)+"</a></div>",w.labelIcon=N?"":'<h6 class="ff-label-wrapper"><i class="ff-icon"><i class="ff-icon-inner"><span class="ff-label-text">'+l.type+"</span></i></i></h6>";for(var M=0,z=s.template.length;M<z;M++)1===M&&_&&(p+='<div class="ff-overlay-wrapper">'),p+=w[s.template[M]],"meta"===s.template[M]&&(p+=w.labelIcon),M===z-1&&_&&(p+='<h6 class="ff-item-bar">'+u+k+"</h6>",p+='<div class="ff-overlay"></div></div>');T+='<article class="ff-item'+(l.media&&"image"!=l.media.type?" ff-video-preview":"")+" ff-"+l.type+("meta"===s.template[s.isOverlay?1:0]||!l.img&&"meta"===s.template[1]?" ff-meta-first":"")+(l.header?" ff-has-header":"")+(l.img?" ff-image":" ff-no-image")+(_?" ff-has-overlay":"")+'" id="ff-uid-'+E+'" post-id="'+l.id+'" data-type="'+l.type+'" data-index="'+(o+r)+'"'+I+' data-timestamp="'+l.system_timestamp+'">'+(n&&l.mod?S:"")+'<div class="picture-item__inner"><div class="ff-item-cont">'+p+"</div>"+(_?"":'<h6 class="ff-item-bar">'+u+k+"</h6>"),O&&(T+='<a class="ff-mob-link" href="'+l.permalink+'"></a>'),T+="</div></article>"}else d="yep"===l.label?'data-label="'+l.labelTxt+";"+l.labelCol+'"':"",f='style="'+(l.textCol?"color:"+l.textCol+";":"")+("js"===l.adtype?"height:"+l.height+"px":"")+'"',T+='<div class="ff-item ff-'+l.type+(l.permalink?" ff-ad-link":"")+'" id="ff-uid-'+E+'" post-id="'+l.id+'" data-type="'+l.type+'" data-adtype="'+l.adtype+'" data-index="'+o+'" '+d+'><div class="picture-item__inner" style="'+(l.cardBG?"background-color:"+l.cardBG+";":"")+'"><div class="ff-item-cont"><div class="ff-content" '+f+">"+l.text.replace(/document\.write\((.+?)\)/i,function(t,e){return"jQuery("+e+').appendTo(jQuery("#ff-uid-'+E+' .ff-content"))'})+"</div>",l.permalink&&(T+='<a class="ff-link" href="'+l.permalink+'"></a>'),T+="</div></div></div>";E++}return T}function M(e,s){clearTimeout(n),C||(e.find(".ff-item").each(z),C=!0),n=setTimeout(function(){if(M.finder,e.find(".ff-highlight").each(function(){T(this).replaceWith(this.childNodes)}),s){var t="justified"!==e.data("opts").layout?"shuffleCustom":"rowGrid";e[t]("shuffle",function(t,e){var i,n;return(!e||"all"===e.group||-1!==T.inArray(e.group,t.data("groups")))&&((i=t.find(':contains("'+s+'")')).length&&i.first().find("*").filter(function(){var t=T(this);return!t.children().length||t.is("p")}).each(function(t,e){T(e).is("p")?M.finder=window.findAndReplaceDOMText(e,{find:new RegExp(s,"i"),wrap:"span",clss:"ff-highlight"}):T(e).html(function(t,e){return e.replace(new RegExp(s,"i"),function(t){return'<span class="ff-highlight">'+t+"</span>"})})}),i.length||(n=-1!==(n=T.trim(t.attr("data-type")).toLowerCase()).indexOf(s)),i.length||n)},"only_sort")}},100)}function f(c,i,t,e,p,n){c.find(".shuffle__sizer");var u,m,s,r,a=c.find(".ff-item"),o="grid"===p.layout?"":"masonry"===p.layout?"m-":"j-",l={columns:[{size:1e4,val:p[o+"c-desktop"]},{size:1200,val:p[o+"c-laptop"]},{size:1024,val:p[o+"c-tablet-l"]},{size:768,val:p[o+"c-tablet-p"]},{size:480,val:p[o+"c-smart-l"]},{size:380,val:p[o+"c-smart-p"]}],spacing:[{size:1e4,val:p[o+"s-desktop"]},{size:1200,val:p[o+"s-laptop"]},{size:1024,val:p[o+"s-tablet-l"]},{size:768,val:p[o+"s-tablet-p"]},{size:480,val:p[o+"s-smart-l"]},{size:380,val:p[o+"s-smart-p"]}],row:[{size:1e4,val:p[o+"h-desktop"]},{size:1200,val:p[o+"h-laptop"]},{size:1024,val:p[o+"h-tablet-l"]},{size:768,val:p[o+"h-tablet-p"]},{size:480,val:p[o+"h-smart-l"]},{size:380,val:p[o+"h-smart-p"]}]};return v(a),"justified"!==p.layout?(c.shuffleCustom({itemSelector:".ff-item",gutterWidth:function(t){var e=Array.prototype.slice.call(arguments);return e.push(l.spacing),function(t,e){var i,n,s;for(i=e.length;i--;)if(s=e[i].size,t<s){n=parseInt(e[i].val);break}return n}.apply(null,e)},columnWidth:function(t,e){var i=Array.prototype.slice.call(arguments);e||this._itemMargin;return i.push(l.columns),function(t,e,i){var n,s,r,a;for(n=i.length;n--;)if(r=i[n].size,t<r){a=parseInt(i[n].val),s=(t-2*e-e*(a-1))/a;break}return s?Math.floor(s):260}.apply(null,i)},streamOpts:p}),c.on("done.shuffle",function(){setTimeout(function(){u.layout(),n.find(".ff-loadmore-wrapper").css("visibility","visible")},0)})):(c.rowGrid({minMargin:5,maxMargin:5,itemSelector:".ff-item",firstItemClass:"first-item",resize:!0,sizes:l,streamOpts:p}),setTimeout(function(){n.find(".ff-loadmore-wrapper").css("visibility","visible")},0)),e&&(s=c.parent(),m=new CBPGridGallery(s,{iconStyle:p["icons-style"]}),r=s.find(".ff-slideshow").attr("id",s.attr("id")+"-slideshow"),"yep"===p.hidemeta&&r.addClass("ff-hide-meta"),setTimeout(function(){document.body.appendChild(r.get(0))},0)),window.requestAnimationFrame&&g(0,a),c.find(".ff-item:not(.ff-ad) .ff-content").dotdotdot({ellipsis:"...",after:""}),u=c.data("shuffle"),i&&(i=parseInt(i),c.addClass("ff-slider").parent().css("paddingBottom","70px"),function(e,s,t,i){var n,r=T('<span class="ff-control-prev"/>'),a=T('<span class="ff-control-next"/>'),o=Math.ceil(t.$items.length/s);r.on("click",l),a.on("click",d),O&&function(t,n,s){var r,a,o,l,d;t.bind("touchstart",function(t){o=(new Date).getTime(),r=t.originalEvent.touches[0].pageX,a=t.originalEvent.touches[0].clientY}).bind("touchmove",function(t){l=t.originalEvent.touches[0].pageX,d=t.originalEvent.touches[0].clientY}).bind("touchend",function(){var t=r<l?"right":"left",e=60<d-a||d-a<-60,i=60<l-r||l-r<-60;if(!(300<(new Date).getTime()-o||e)&&i)switch(t){case"left":s();break;case"right":n()}})}(e,l,d);function l(){var t=n.data("currentSlide")-1;t<1&&(t=o),n.data("currentSlide",t),f(t),i&&setTimeout(h,0)}function d(){var t=n.data("currentSlide")+1;o<t&&(t=1),n.data("currentSlide",t),f(t),i&&setTimeout(h,0)}function f(n){e.shuffleCustom("shuffle",function(t,e){var i;return("all"===e.group||-1!==T.inArray(e.group,t.data("groups")))&&(i=t.attr("data-index"),s*(n-1)<i&&i<=s*n)})}function h(){var t=e.offset().top;T("html, body").animate({scrollTop:t-100},300)}(n=T('<div class="ff-controls-wrapper"></div>').append(r).append(a)).data("currentSlide",1),e.on("layout.shuffle",function(){}),e.append(n)}(c,i,u,t),c.shuffleCustom("shuffle",function(t,e){return parseInt(t.attr("data-index"))<=i}),c.data("num",a.length),c.data("visible",0)),n.find(".ff-loadmore-wrapper span").click(function(){var d=T(this),f=n.find(".ff-loader"),h=n.find(".ff-item").not(".ff-ad").length,t={action:"fetch_posts","stream-id":p.id,page:p["next-page"],countOfPages:p.countOfPages,hash:p.hash};d.css("opacity",0),f.insertAfter(d).show().removeClass("ff-squeezed"),T.get(FlowFlowOpts.ajaxurl,t,function(t){var e=JSON.parse(t),i=e.items,n=(i.length,E(i,T('[id^="ff-uid-"]').length+1||1,!0,F.moderation,p)),s=T(n),r=s.not(".ff-ad"),a=r.toArray();if(c.trigger("loaded_more",{items:s}),p.hash=e.hash,p["next-page"]=e.page+1,p.countOfPages=e.countOfPages,c.append(s),"justified"!==p.layout?c.shuffleCustom("appended",s):c.rowGrid("appended"),v(s),window.requestAnimationFrame&&g(0,s),r.each(function(){T(this).find("img").not(":first").remove()}),s.find("img").each(function(){N.apply(this,[c])}),"yep"===F.open_in_new){var o=location.hostname;s.find("a").filter(function(){return this.hostname!=o}).attr("target","_blank")}if(m&&(m._addSlideShowItems(a),m.initItemsEvents(a,h),m.slideshowItems=[].slice.call(m.slideshow.children),m.itemsCount=m.itemsCount+r.length),k(r,p),f.addClass("ff-squeezed").delay(300).hide(),setTimeout(function(){r.filter(":lt(5)").addClass("in"),r.find(".ff-content").dotdotdot({ellipsis:"...",after:""}),setTimeout(function(){e.page+1!=e.countOfPages?d.css("opacity",1):d.remove(),u.layout()},200)},14),FlowFlowOpts.dependencies.ads&&e.ads){var l=jQuery.post(F.ajaxurl,{action:"flow_flow_ad_action",status:"view",id:e.ads});T.when(l).always(function(t){})}})}),u}function g(t,e){e.each(function(){FF_Viewport.add({element:this,threshold:130,enter:z,leave:u})})}function v(t){t.find(".picture-item__inner").addClass("picture-item__inner--transition")}function z(){T(this).addClass("in").data("viewport","in")}function u(){T(this).data("viewport","out")}function A(t,e,i,n){return t=Number(t),!1!==(n=n||!1)?m(t,e,i,n):m(t,e,i,1e12<=t?"T":1e9<=t?"B":1e6<=t?"M":1e3<=t?"K":"")}function m(t,e,i,n){var s=0;switch(n){case"T":s=t/1e12;break;case"B":s=t/1e9;break;case"M":s=t/1e6;break;case"K":s=t/1e3;break;case"":s=t}!1!==e&&new RegExp("\\.\\d{"+(e+1)+",}$").test(""+s)&&(s=s.toFixed(e));return!1!==i&&(s=Number(s).toFixed(i)),s+n}window.FlowFlow=l.init()}(jQuery),jQuery(document).on("done.shuffle",function(t,e){jQuery(function(){setTimeout(function(){},500)})});